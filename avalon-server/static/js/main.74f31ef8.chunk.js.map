{"version":3,"sources":["App.js","serviceWorker.js","index.js"],"names":["App","useState","mode","setMode","players","setPlayers","roles","setRoles","auth","setAuth","message","setMessage","gameState","setGameState","myState","setMyState","url_components","window","location","pathname","split","length","name","key","useEffect","interval","setInterval","fetch","then","res","json","success","data","console","log","clearInterval","mode_tag","custom_content","vote","render_vote","players_html","map","player","onClick","kick","roles_html","Object","keys","role","toggle","captain","i","player_approve_box","toggleProposal","className","proposal","includes","proposed","player_info_box","skips","votes","vote_details_box","did_vote_box","captain_view","approve_view","act_view","round","successes","fails","render_round","assassin_mode","approved","act","Container","Boolean","hostname","match","ReactDOM","render","StrictMode","rel","href","integrity","crossOrigin","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error"],"mappings":"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","file":"static/js/main.74f31ef8.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport './App.css'\nimport { Container } from 'react-bootstrap'\n\nfunction App() {\n  const [mode, setMode] = useState('lobby')\n  const [players, setPlayers] = useState([])\n  const [roles, setRoles] = useState({})\n  const [auth, setAuth] = useState(false)\n  const [message, setMessage] = useState(\"\")\n  const [gameState, setGameState] = useState({'round': 0, 'successes': [], 'fails': [], 'mission': 0, 'captain': 0, 'skips': 0, 'proposed': false, 'approved': false, 'proposal': [], 'votes': [], 'hypertext': 'ReactJS is legendary', 'assassin_mode': false})\n  const [myState, setMyState] = useState({'i': 0, 'roles': [], 'vote': '', 'act': '', 'assassin': false});\n  const url_components = window.location.pathname.split('/')\n  let [name, key] = url_components[url_components.length - 1].split('-')\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      fetch('/server/auth/' + name + '/' + key).then(res => res.json()).then(res => setAuth(res.success))\n      fetch('/server/get_mode').then(res => res.json()).then(res => {if (res.success) setMode(res.data)})\n      fetch('/server/lobby/get_players').then(res => res.json()).then(res => {if (res.success) setPlayers(res.data)})\n      fetch('/server/lobby/get_roles').then(res => res.json()).then(res => {if (res.success) {console.log(res.data); setRoles(res.data)}})\n      fetch('/server/game/get_game_state/' + name + '/' + key).then(res => res.json()).then(res => {if (res.success) setGameState(res)})\n      fetch('/server/game/get_my_state/' + name + '/' + key).then(res => res.json()).then(res => {if (res.success) setMyState(res)})\n    }, 1000)\n\n    return () => {\n      clearInterval(interval)\n    }\n  })\n\n  const mode_tag = <p>[{mode}]</p>\n\n  let custom_content = null\n\n  const kick = (player) => {\n    fetch('/server/lobby/kick/' + player)\n  }\n\n  const toggle = (role) => {\n    fetch('/server/lobby/toggle/' + role)\n  }\n  \n  const startGame = () => {\n    fetch('/server/lobby/start_game').then(res => res.json()).then(res => setMessage(res.message))\n  }\n\n  const toggleProposal = (player) => {\n    fetch('/server/game/toggle_proposal/' + name + '/' + key + '/' + player)\n  }\n\n  const proposeTeam = () => {\n    fetch('/server/game/propose_team/' + name + '/' + key).then(res => res.json()).then(res => setMessage(res.message))\n  }\n\n  const vote = (vote) => {\n    fetch('/server/game/vote/' + name + '/' + key + '/' + vote)\n  }\n\n  const render_vote = (vote) => vote === 'approve' ? 'âœ…' : vote === 'disapprove' ? 'ðŸ›‘' : '...'\n\n  const hammer = () => (gameState.captain + 5 - gameState.skips) % players.length;\n\n  let players_html = null;\n  // eslint-disable-next-line\n  let roles_html = null;\n\n  switch (mode) {\n    case 'lobby':\n      players_html = players.map(player => (\n        <tr key={player}>\n          <td><button onClick={() => kick(player)}>Kick</button></td>\n          <td>{player}</td>\n        </tr>\n      ))\n      let roles_html = Object.keys(roles).map(role => (\n        <tr key={role}>\n          <td><button onClick={() => toggle(role)}>{roles[role] ? \"disable\" : \"enable\"}</button></td>\n          <td>{role}</td>\n        </tr>\n      ))\n      custom_content = (\n        <div>\n          <h1>Players</h1>\n          <table><tbody>{players_html}</tbody></table>\n          <h1>Roles</h1>\n          <table><tbody>{roles_html}</tbody></table>\n          <button onClick={() => startGame()}>Start Game!</button>\n          <p>{message}</p>\n        </div>\n      )\n      break\n    case 'game':\n      const captain = myState.i === gameState.captain\n      const player_approve_box = (player, i) => (\n        <button onClick={() => toggleProposal(player)} className={gameState.proposal.includes(player) ? 'active' : 'inactive'}>{gameState.proposal && gameState.proposal.includes(player) ? \"Remove\" : \"Add\"}</button>\n      )\n      const player_info_box = (player, i) => (\n        <p>{gameState.proposal.includes(player) ? 'On team' : ''}</p>\n      )\n      const did_vote_box = (player, i) =>  (\n        <td>{i === myState.i ? render_vote(myState.vote) : gameState.votes.includes(player) ? \"VotedðŸ“¨\" : \"...\"}</td>\n      )\n      const vote_details_box = (player, i) => (\n        <td>{render_vote(gameState.votes[i])}</td>\n      )\n      players_html = players.map((player, i) => (\n        <tr key={player}>\n          <td>{captain && !gameState.proposed ? player_approve_box(player, i) : player_info_box(player, i)}</td>\n          <td>{i === hammer() ? 'Hammer' : i === gameState.captain ? 'Captain' : ''}</td>\n          <td>{player}</td>\n          <td>{myState.roles[i]}</td>\n          {gameState.votes.length === players.length ? vote_details_box(player, i) : did_vote_box(player, i)}\n        </tr>\n        ))\n      const captain_view = <p><button onClick={proposeTeam}>Propose the team</button></p>\n      const approve_view = (\n        <div>\n          <button onClick={() => vote('approve')} className={myState.vote ==='approve' ? 'active' : 'inactive'}>Approve</button>\n          <button onClick={() => vote('disapprove')} className={myState.vote ==='disapprove' ? 'active' : 'inactive'}>Reject</button>\n        </div>\n      )\n      const act_view = (\n        <div>\n          <button onClick={() => fetch('/server/game/act/' + name + '/' + key + '/success')} className='succeed'>Succeed</button>\n          <button onClick={() => fetch('/server/game/act/' + name + '/' + key + '/fail')} className='fail'>Fail</button>\n        </div>\n      )\n      const render_round = (round) => (\n        (gameState.successes.includes(round) ? \"W\" : gameState.fails.includes(round) ? \"L\" : \"_\") + \" \"\n      )\n      custom_content = (\n        <div>\n          <p>{[0, 1, 2, 3, 4].map(round => render_round(round))}</p>\n          <p>Rejected teams: {gameState.skips}</p> \n          <h1>Players</h1>\n          <table className=\"table\"><tbody>{players_html}</tbody></table>\n          {gameState.assassin_mode ? '' : gameState.approved ? (gameState.proposal.includes(name) && myState.act === '' ? act_view : \"It's time for a vote!\") : gameState.proposed ? approve_view : captain ? captain_view : \"\"}\n          <p>{message}</p>\n        </div>\n      )\n      break\n    default:\n      break\n  }\n\n  if (!auth) {\n    custom_content = <p>Authentication failed!</p>\n  }\n\n  return (\n    <Container className=\"justify-content-md-center\">\n      <h3>{gameState['hypertext']}</h3>\n        {mode_tag}\n        {custom_content}\n    </Container>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <link\n      rel=\"stylesheet\"\n      href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css\"\n      integrity=\"sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh\"\n      crossOrigin=\"anonymous\"\n    />\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}