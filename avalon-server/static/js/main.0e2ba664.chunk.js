(this["webpackJsonpavalon-client"]=this["webpackJsonpavalon-client"]||[]).push([[0],{13:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(4),l=n.n(r),o=n(1),s=(n(13),n(17));var u=function(){var e=Object(a.useState)("lobby"),t=Object(o.a)(e,2),n=t[0],r=t[1],l=Object(a.useState)([]),u=Object(o.a)(l,2),i=u[0],m=u[1],f=Object(a.useState)({}),p=Object(o.a)(f,2),d=p[0],v=p[1],h=Object(a.useState)(!1),b=Object(o.a)(h,2),E=b[0],g=b[1],j=Object(a.useState)(""),k=Object(o.a)(j,2),y=k[0],O=k[1],w=Object(a.useState)({round:0,successes:[],fails:[],mission:0,captain:0,skips:0,proposed:!1,approved:!1,proposal:[],votes:[],hypertext:"ReactJS is legendary",assassin_mode:!1,rounds:[0,0,0,0,0],actors:[]}),_=Object(o.a)(w,2),C=_[0],S=_[1],N=Object(a.useState)({i:0,roles:[],vote:"",act:"",assassin:!1,good:!0}),x=Object(o.a)(N,2),I=x[0],P=x[1],R=Object(a.useState)([]),B=Object(o.a)(R,2),A=B[0],W=B[1],F=window.location.pathname.split("/"),G=F[F.length-1].split("-"),J=Object(o.a)(G,2),K=J[0],M=J[1];Object(a.useEffect)((function(){var e=setInterval((function(){fetch("/server/auth/"+K+"/"+M).then((function(e){return e.json()})).then((function(e){return g(e.success)})),fetch("/server/get_mode").then((function(e){return e.json()})).then((function(e){e.success&&r(e.data)})),fetch("/server/lobby/get_players").then((function(e){return e.json()})).then((function(e){e.success&&m(e.data)})),fetch("/server/lobby/get_roles").then((function(e){return e.json()})).then((function(e){e.success&&v(e.data)})),fetch("/server/game/get_game_state/"+K+"/"+M).then((function(e){return e.json()})).then((function(e){e.success&&S(e)})),fetch("/server/game/get_my_state/"+K+"/"+M).then((function(e){return e.json()})).then((function(e){e.success&&P(e)})),fetch("/server/get_kicked").then((function(e){return e.json()})).then((function(e){e.success&&W(e.data)}))}),500);return function(){clearInterval(e)}}));var V=null,L=function(e){fetch("/server/game/vote/"+K+"/"+M+"/"+e)},Q=function(e){return"approve"===e?"\u2705":"disapprove"===e?"\ud83d\uded1":"..."},T=function(){return(C.captain+4-C.skips)%i.length},q=null;switch(n){case"lobby":q=i.map((function(e){return c.a.createElement("tr",{key:e},c.a.createElement("td",null,c.a.createElement("button",{onClick:function(){return function(e){fetch("/server/lobby/kick/"+e)}(e)}},"Kick")),c.a.createElement("td",null,e))}));var H=Object.keys(d).map((function(e){return c.a.createElement("tr",{key:e},c.a.createElement("td",null,c.a.createElement("button",{onClick:function(){return function(e){fetch("/server/lobby/toggle/"+e)}(e)}},d[e]?"disable":"enable")),c.a.createElement("td",{className:d[e]?"activeRole":"inactiveRole"},e))}));V=c.a.createElement("div",null,c.a.createElement("h1",null,"Players"),c.a.createElement("table",null,c.a.createElement("tbody",null,q)),c.a.createElement("h1",null,"Roles"),c.a.createElement("table",null,c.a.createElement("tbody",null,H)),c.a.createElement("button",{onClick:function(){fetch("/server/lobby/start_game").then((function(e){return e.json()})).then((function(e){return O(e.message)}))}},"Start Game!"),c.a.createElement("p",null,y));break;case"game":var X=I.i===C.captain,$=function(e,t){return c.a.createElement("button",{onClick:function(){return function(e){fetch("/server/game/toggle_proposal/"+K+"/"+M+"/"+e)}(e)},className:C.proposal.includes(e)?"active":"inactive"},C.proposal&&C.proposal.includes(e)?"Remove":"Add")};q=i.map((function(e,t){return c.a.createElement("tr",{key:e},c.a.createElement("td",null,X&&!C.proposed?$(e):function(e,t){return c.a.createElement("p",null,C.actors.includes(e)?"Acted":C.proposal.includes(e)?"On team":"")}(e)),c.a.createElement("td",null,t===T()&&t===C.captain?"\ud83d\udfe0\ud83d\udd28":t===T()?"\ud83d\udd28":t===C.captain?"\ud83d\udfe0":""),c.a.createElement("td",null,e),c.a.createElement("td",null,I.roles[t]),C.votes.length===i.length?function(e,t){return c.a.createElement("td",null,Q(C.votes[t]))}(0,t):function(e,t){return c.a.createElement("td",null,t===I.i?Q(I.vote):C.votes.includes(e)?"Voted\ud83d\udce8":"...")}(e,t))}));var z=c.a.createElement("p",null,c.a.createElement("button",{onClick:function(){fetch("/server/game/propose_team/"+K+"/"+M).then((function(e){return e.json()})).then((function(e){return O(e.message)}))}},"Propose the team")),D=c.a.createElement("div",null,c.a.createElement("button",{onClick:function(){return L("approve")},className:"approve"===I.vote?"active":"inactive"},"Approve"),c.a.createElement("button",{onClick:function(){return L("disapprove")},className:"disapprove"===I.vote?"active":"inactive"},"Reject")),U=I.good?null:c.a.createElement("button",{onClick:function(){return fetch("/server/game/act/"+K+"/"+M+"/fail")},className:"fail"},"Fail"),Y=c.a.createElement("div",null,c.a.createElement("button",{onClick:function(){return fetch("/server/game/act/"+K+"/"+M+"/success")},className:"succeed"},"Succeed"),U);V=c.a.createElement("div",null,c.a.createElement("p",null,[0,1,2,3,4].map((function(e){return function(e){return(C.successes.includes(e)?"W":C.fails.includes(e)?"L":"_")+" "}(e)}))),c.a.createElement("p",null,"Players required per mission (.1 = 2 fails needed): ",[0,1,2,3,4].map((function(e){return function(e){return C.rounds[e]+", "}(e)}))),c.a.createElement("p",null,"Rejected teams: ",C.skips),c.a.createElement("h1",null,"Players"),c.a.createElement("table",{className:"table"},c.a.createElement("tbody",null,q)),C.assassin_mode?"":C.approved?C.proposal.includes(K)&&""===I.act?Y:"It's time for a vote!":C.proposed?D:X?z:"",c.a.createElement("p",null,y))}E||(V=c.a.createElement("div",null,c.a.createElement("p",null,"Authentication failed!"),c.a.createElement("p",null,"Name"),c.a.createElement("textarea",{id:"name",rows:"1"}),c.a.createElement("p",null,"Password"),c.a.createElement("textarea",{id:"password",rows:"1"}),c.a.createElement("button",{onClick:function(){var e=document.getElementById("name").value,t=document.getElementById("password").value;window.location.pathname="/user/"+e+"-"+t}},"Log in")));var Z="lobby"===n?"unreset":"reset",ee=E?c.a.createElement("button",{onClick:function(){return fetch("/server/"+Z)}},Z):null;return c.a.createElement(s.a,{className:"justify-content-md-center"},c.a.createElement("h3",null,C.hypertext),ee,"Mode ",n,", Kicked: ",A.map((function(e){return e+", "})),V)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(14);l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement("link",{rel:"stylesheet",href:"https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css",integrity:"sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh",crossOrigin:"anonymous"}),c.a.createElement(u,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,n){e.exports=n(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.0e2ba664.chunk.js.map